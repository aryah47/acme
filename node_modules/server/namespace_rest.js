//namespace_rest.js
 "use strict";

var dbapi = require('server/dbapi');

module.exports = {
    main : function (app) {
        app.get('/api/namespace', function (req, res) {
            dbapi.readAll('Namespaces', req.query).done(function (acc) {
                return res.send(acc);
            });
        });
        app.post('/api/namespace', function (req, res) {
            dbapi.create('Namespaces', {'name': req.body.name}).done(function (info) {
                return res.send(info);
            });
        });
        app.get('/api/namespace/:id', function (req, res) {
            var id = req.params.id;
            dbapi.read('Namespaces', id).done(function (row) {
                return res.send(row);
            });
        });
        var fnNsUpdate = function (req, res) {
            var id = req.params.id;
            dbapi.update('Namespaces', id, {"name" : req.body.name}).done(function (info) {
                return res.send(info);
            });
        };
        app.put('/api/namespace/:id', fnNsUpdate);
        app.patch('/api/namespace/:id', fnNsUpdate);

        app.delete('/api/namespace/:id', function (req, res) {
            var id = req.params.id;
            dbapi.del('Namespaces', id).done(function (info) {
                return res.send(info);
            });
        });
        return app;
    }
};
