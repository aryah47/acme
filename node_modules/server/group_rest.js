//group_rest.js

var dbapi = require('server/dbapi');
module.exports = {
    main : function (app) {
        app.get('/api/group', function (req, res) {
            dbapi.readAll('Groups', req.query).done(function (acc) {
                return res.send(acc);
            });
        });
        app.post('/api/group', function (req, res) {
            dbapi.create('Groups', {'name' : req.body.name}).done(function (info) {
                return res.send(info);
            });
        });
        app.get('/api/group/:id', function (req, res) {
            var id = req.params.id;
            dbapi.read('Groups', id).done(function (row) {
                return res.send(row);
            });
        });

        var fnGrpUpdate = function (req, res) {
            var id = req.params.id;
            dbapi.update('Groups', id, {'name' : req.body.name}).done(function (info) {
                return res.send(info);
            });
        };
        app.put('/api/group/:id', fnGrpUpdate);
        app.patch('/api/group/:id', fnGrpUpdate);

        app.delete('/api/group/:id',function (req, res) {
            var id = req.params.id;
            dbapi.del('Groups', id).done(function (info) {
                return res.send(info);
            });
        });
        return app;
    }
};
